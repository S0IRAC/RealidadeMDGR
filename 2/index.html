<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Cenário DS - Sala e Robot</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script>
      AFRAME.registerComponent('video-handler', {
        init: function () {
          const sceneEl = this.el;
          let currentVideo = null;

          sceneEl.querySelectorAll('.clickable').forEach(el => {
            el.addEventListener('mouseenter', () => {
              const videoId = el.getAttribute('data-video');
              if (!videoId) return;

              if (currentVideo && currentVideo !== videoId) {
                const oldEl = sceneEl.querySelector('#' + currentVideo);
                if (oldEl) {
                  oldEl.setAttribute('visible', 'false');
                  oldEl.pause();
                }
              }

              const videoEl = sceneEl.querySelector('#' + videoId);
              if (videoEl) {
                videoEl.setAttribute('visible', 'true');
                videoEl.play();
                currentVideo = videoId;
              }
            });
          });

          sceneEl.addEventListener('click', () => {
            if (currentVideo) {
              const videoEl = sceneEl.querySelector('#' + currentVideo);
              if (videoEl) {
                videoEl.setAttribute('visible', 'false');
                videoEl.pause();
              }
              currentVideo = null;
            }
          });
        }
      });
    </script>
  </head>
  <body>
    <a-scene video-handler>
      <!-- Fundo 360º com a imagem da sala -->
      <a-sky src="Robots/cena2.png" rotation="0 -90 0"></a-sky>

      <a-image src="Robots/LOGÍSTICA .png"
               position="-6.5 2.0 5.0"
               rotation="10 160 0"
               width="12.0" height="3.3"
               look-at="[camera]">
      </a-image>

      <!-- Robô principal -->
      <a-image class="clickable" data-video="video1"
               src="Robots/Robô Logo Escola.png"
               position="0.9 1.1 -3.5"
               width="3" height="2"
               look-at="[camera]">
      </a-image>
      <a-video id="video1" src="#src1" position="0.9 2.5 -3.5" width="3" height="1.5" visible="false"></a-video>
      <video id="src1" crossorigin="anonymous" loop>
        <source src="videos/video1.mp4" type="video/mp4">
      </video>

      <!-- Robô com celular -->
      <a-image class="clickable" data-video="video2"
               src="Robots/Robô com celular.png"
               position="3.5 0.25 -2.0"
               rotation="-10 -60 0"
               width="1.6" height="1.6"
               look-at="[camera]">
      </a-image>
      <a-video id="video2" src="#src2" position="3.5 1.7 -2.0" width="3" height="1.5" visible="false"></a-video>
      <video id="src2" crossorigin="anonymous" loop>
        <source src="videos/video2.mp4" type="video/mp4">
      </video>

      <!-- Robô lendo -->
      <a-image class="clickable" data-video="video3"
               id="convite-video"
               src="Robots/Robô lendo sobre a bancada .png"
               position="25.2 -2.3 -0.7"
               rotation="0 -30 0"
               width="10.2" height="10.4"
               look-at="[camera]">
      </a-image>
      <a-video id="video3" src="#src3" position="25.2 -1.0 -0.7" width="6" height="3" visible="false"></a-video>
      <video id="src3" crossorigin="anonymous" loop>
        <source src="videos/video3.mp4" type="video/mp4">
      </video>

      <!-- Robô gamer -->
      <a-entity position="0 -0.5 0">
        <a-curvedimage class="clickable" data-video="video4"
                       src="Robots/Robô gamer .png"
                       height="4"
                       radius="6"
                       theta-length="20"
                       theta-start="42.5"
                       rotation="0 0 0"
                       look-at="[camera]">
        </a-curvedimage>
        <a-video id="video4" src="#src4" position="0 1.5 -3" width="3" height="1.5" visible="false"></a-video>
        <video id="src4" crossorigin="anonymous" loop>
          <source src="videos/video4.mp4" type="video/mp4">
        </video>
      </a-entity>

      <!-- Outros robôs podem ser ajustados da mesma forma -->

      <!-- Narração -->
      <a-sound src="#audio" autoplay="true" position="1.2 2.0 -3"></a-sound>
      <audio id="audio" crossorigin="anonymous">
        <source src="narracao_robot_desenvolvimento_sistemas_resumida.mp3" type="audio/mp3">
      </audio>

      <!-- Câmera com cursor -->
      <a-camera look-controls>
        <a-cursor fuse="true" fuse-timeout="1500" color="white"></a-cursor>
      </a-camera>
    </a-scene>
  </body>
</html>
